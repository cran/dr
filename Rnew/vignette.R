###################################################
### chunk number 1: a1
###################################################
setwd("C://Documents and Settings//sandy//My Documents//dr3//dr//Rnew")
library(alr3)
data(ais)
ais$one <- rep(1,202)
source("dr.R")
source("psir.R")
source("psaveORIG.R")
summary(s0 <- dr(LBM~log(SSF)+log(Wt)+log(Hg)+log(Ht)+log(WCC)+log(RCC)+
  log(Hc)+log(Ferr),nslices=5,data=ais))
summary(s1 <- update(s0, group=~one,nslices=5))
summary(s2 <- update(s0,method="save",nslices=10))
summary(s3 <- update(s2,method="save",nslices=10,group=~one))

###################################################
### chunk number 2: a2
###################################################
dr.coordinate.test(s0,hypothesis=~.-log(Hg))


###################################################
### chunk number 3: a2
###################################################
m0 <- drop1(s0)


###################################################
### chunk number 4: 
###################################################
class(s0)


###################################################
### chunk number 5: 
###################################################
names(s0)


###################################################
### chunk number 6: 
###################################################
s0$evectors


###################################################
### chunk number 7: a2
###################################################
s1 <- update(s0,method="save")
summary(s1)


###################################################
### chunk number 8: save
###################################################
drop1(s1,update=FALSE)


###################################################
### chunk number 9: 
###################################################
summary(s2 <- update(s0,method="phdres"))


###################################################
### chunk number 10: one
###################################################
(m1 <- dr(LBM~log(Ht)+log(Wt)+log(SSF)+log(RCC)+log(WCC)+log(Ferr)+
           log(Hc)+log(Hg),data=ais,method="ire",nslices=8,numdir=4,
           slice.function=dr.slices.arc,itmax=200,steps=1,eps=1.e-6))


###################################################
### chunk number 11: two
###################################################
dr.basis(m1,2)


###################################################
### chunk number 12: three
###################################################
dr.basis(m1,3)


###################################################
### chunk number 13: mct
###################################################
dr.coordinate.test(m1,~.-log(Hg))


###################################################
### chunk number 14: mct2
###################################################
dr.coordinate.test(m1,~.-log(Hg),d=2)


###################################################
### chunk number 15: drop1
###################################################
drop1(m1,update=FALSE)


###################################################
### chunk number 16: step
###################################################
dr.step(m1)


###################################################
### chunk number 17: pire
###################################################
m2 <- dr(LBM~log(Ht)+log(Wt)+log(SSF)+log(RCC)+log(WCC)+log(Ferr)+
           log(Hc)+log(Hg),group=~Sex,data=ais,method="ire",nslices=8,
           numdir=4,slice.function=dr.slices.arc,itmax=200,steps=1,
           eps=1.e-6)


###################################################
### chunk number 18: pire1
###################################################
m2


###################################################
### chunk number 19: 
###################################################
wts <- dr.weights(LBM~Ht+Wt+RCC+WCC,data=ais)
i1 <- dr(LBM~Ht+Wt+RCC+WCC,weights=wts,method="phdres",data=ais)


###################################################
### chunk number 20: 
###################################################
y1 <- c(1,1,1,2,3,4,5,6,7,8,8,8)
dr.slices(y1,3)


###################################################
### chunk number 21: 
###################################################
y2 <- c(1,2,3,4,1,2,3,4,1,2,3,4)
dr.slices(cbind(y1,y2),5)
